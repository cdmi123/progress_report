<div class="container-fluid py-4">
  <!-- Page Header -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <div>
      <h2 class="fw-bold text-primary">
        <i class="bi bi-person-plus-fill me-2"></i> Add New Staff
      </h2>
      <p class="text-muted mb-0">Create a new staff account with the details below</p>
    </div>
    <a href="/admin/students" class="btn btn-outline-primary d-flex align-items-center">
      <i class="bi bi-arrow-left me-2"></i> Back to Staff List
    </a>
  </div>

  <!-- Form Card -->
  <div class="card border-0 shadow-sm">
    <div class="card-header bg-white border-0 py-3">
      <h5 class="card-title mb-0">
        <i class="bi bi-person-badge me-2 text-primary"></i> Staff Information
      </h5>
    </div>
    <div class="card-body">
      <form method="POST" action="/admin/register" id="staffForm">
        <input type="hidden" id="signatureData" name="signatureData">
        
        <div class="row g-4">
          <div class="col-md-6">
            <div class="form-floating mb-3">
              <input name="email" type="email" class="form-control" id="email" placeholder="name@example.com" required>
              <label for="email">
                <i class="bi bi-envelope me-1"></i> Email Address
              </label>
            </div>
          </div>
          
          <div class="col-md-6">
            <div class="form-floating mb-3">
              <input name="password" type="password" class="form-control" id="password" placeholder="Password" required>
              <label for="password">
                <i class="bi bi-lock me-1"></i> Password
              </label>
            </div>
          </div>
          
          <div class="col-md-6">
            <div class="form-floating mb-3">
              <input name="contact" type="tel" class="form-control" id="contact" placeholder="1234567890" 
                     pattern="^[0-9]{10}$" title="Enter a 10-digit mobile number" required>
              <label for="contact">
                <i class="bi bi-telephone me-1"></i> Phone Number
              </label>
              <div class="form-text">Enter a 10-digit mobile number</div>
            </div>
          </div>
          
          <div class="col-md-6">
            <div class="form-floating mb-3">
              <input name="facultyName" type="text" class="form-control" id="facultyName" placeholder="Faculty Name" required>
              <label for="facultyName">
                <i class="bi bi-building me-1"></i> Faculty Name
              </label>
            </div>
          </div>
        </div>
        
        <div class="d-flex justify-content-between align-items-center mt-4 pt-3 border-top">
          <button type="button" class="btn btn-outline-secondary" data-bs-toggle="modal" data-bs-target="#signatureModal">
            <i class="bi bi-pen me-2"></i> Add Signature
          </button>
          
          <div>
            <button type="reset" class="btn btn-outline-secondary me-2">
              <i class="bi bi-arrow-clockwise me-2"></i> Reset
            </button>
            <button type="submit" class="btn btn-primary">
              <i class="bi bi-check-circle me-2"></i> Save Staff
            </button>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Signature Modal -->
<div class="modal fade" id="signatureModal" tabindex="-1" aria-labelledby="signatureModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content border-0 shadow-lg">
      <div class="modal-header bg-primary text-white border-0">
        <h5 class="modal-title" id="signatureModalLabel">
          <i class="bi bi-pen me-2"></i> Draw Signature
        </h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body p-4">
        <div class="text-center mb-3">
          <p class="text-muted">Please sign in the box below</p>
        </div>
        <div class="border rounded-3 p-2 bg-light">
          <canvas id="signature-pad" width="500" height="200" style="width: 100%; height: 200px;"></canvas>
        </div>
      </div>
      <div class="modal-footer border-0">
        <button type="button" class="btn btn-outline-secondary" onclick="clearSignature()">
          <i class="bi bi-eraser me-2"></i> Clear
        </button>
        <button type="button" class="btn btn-primary" onclick="saveSignature()">
          <i class="bi bi-check-circle me-2"></i> Save Signature
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Signature Script -->
<script src="https://cdn.jsdelivr.net/npm/signature_pad@4.1.5/dist/signature_pad.umd.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.14.0-beta2/js/bootstrap-select.min.js"></script>

<script>
  // Initialize Signature Pad
  const canvas = document.getElementById('signature-pad');
  const signaturePad = new SignaturePad(canvas, {
    backgroundColor: 'rgb(255, 255, 255)',
    penColor: 'rgb(0, 0, 0)'
  });
  
  // Resize canvas to match its display size
  function resizeCanvas() {
    const ratio = Math.max(window.devicePixelRatio || 1, 1);
    canvas.width = canvas.offsetWidth * ratio;
    canvas.height = canvas.offsetHeight * ratio;
    canvas.getContext('2d').scale(ratio, ratio);
    signaturePad.clear();
  }
  
  window.addEventListener('resize', resizeCanvas);
  resizeCanvas();
  
  // Clear signature
  function clearSignature() {
    signaturePad.clear();
  }
  
  // Save signature
  function saveSignature() {
    if (signaturePad.isEmpty()) {
      alert('Please provide a signature first.');
      return;
    }
    
    const dataURL = signaturePad.toDataURL();
    document.getElementById('signatureData').value = dataURL;
    
    // Close modal
    const modal = bootstrap.Modal.getInstance(document.getElementById('signatureModal'));
    modal.hide();
    
    // Show success message
    showNotification('Signature saved successfully!', 'success');
  }
  
  // Form submission
  document.getElementById('staffForm').addEventListener('submit', function(e) {
    const signatureData = document.getElementById('signatureData').value;
    
    if (!signatureData) {
      e.preventDefault();
      showNotification('Please add a signature before submitting.', 'warning');
      document.getElementById('signatureModal').click();
    }
  });
  
  // Show notification
  function showNotification(message, type) {
    const alertDiv = document.createElement('div');
    alertDiv.className = `alert alert-${type} alert-dismissible fade show position-fixed top-0 end-0 m-3`;
    alertDiv.style.zIndex = '9999';
    alertDiv.innerHTML = `
      ${message}
      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    `;
    document.body.appendChild(alertDiv);
    
    // Auto dismiss after 3 seconds
    setTimeout(() => {
      alertDiv.classList.remove('show');
      setTimeout(() => alertDiv.remove(), 150);
    }, 3000);
  }
</script>